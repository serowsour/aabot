<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Onyx | Professional Twitch Operation Center</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/tmi.js@1.8.5/dist/tmi.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg-core: #09090b;
            --bg-panel: #18181b;
            --bg-element: #27272a;
            --border: #3f3f46;
            --accent: #6366f1; /* Indigo 500 */
            --accent-hover: #4f46e5;
            --danger: #ef4444;
            --warning: #f59e0b;
            --success: #10b981;
            --text-main: #f4f4f5;
            --text-muted: #a1a1aa;
        }

        /* Reset & Base */
        * { box-sizing: border-box; scrollbar-width: thin; scrollbar-color: var(--border) var(--bg-core); }
        body {
            background-color: var(--bg-core);
            color: var(--text-main);
            font-family: 'Inter', sans-serif;
            height: 100vh;
            width: 100vw;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        /* Scrollbar Webkit */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: var(--bg-core); }
        ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--text-muted); }

        /* Utility Classes */
        .mono { font-family: 'JetBrains Mono', monospace; }
        .hidden { display: none !important; }
        .flex-center { display: flex; align-items: center; justify-content: center; }
        
        /* Layout Grid */
        .dashboard-grid {
            display: grid;
            grid-template-columns: 260px 1fr 400px; /* Sidebar | Stream | Chat */
            grid-template-rows: 60px 1fr 250px;     /* Header | Main | Bottom Tools */
            height: 100vh;
            width: 100vw;
        }

        /* Specific Areas */
        .area-header { grid-column: 1 / -1; grid-row: 1; border-bottom: 1px solid var(--border); background: var(--bg-panel); display: flex; align-items: center; justify-content: space-between; padding: 0 24px; z-index: 50; }
        .area-sidebar { grid-column: 1; grid-row: 2 / -1; border-right: 1px solid var(--border); background: var(--bg-panel); display: flex; flex-direction: column; }
        .area-stream { grid-column: 2; grid-row: 2; background: #000; position: relative; }
        .area-logs { grid-column: 2; grid-row: 3; border-top: 1px solid var(--border); background: var(--bg-panel); overflow: hidden; display: flex; flex-direction: column; }
        .area-chat { grid-column: 3; grid-row: 2 / -1; border-left: 1px solid var(--border); background: var(--bg-panel); display: flex; flex-direction: column; }

        /* UI Components */
        .btn {
            background: var(--element);
            border: 1px solid var(--border);
            color: var(--text-main);
            padding: 8px 16px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            border-radius: 4px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            justify-content: center;
        }
        .btn:hover { background: var(--border); }
        .btn-primary { background: var(--accent); border-color: var(--accent); color: white; }
        .btn-primary:hover { background: var(--accent-hover); }
        .btn-danger { background: rgba(239, 68, 68, 0.1); border-color: var(--danger); color: var(--danger); }
        .btn-danger:hover { background: var(--danger); color: white; }
        .btn-icon { padding: 8px; width: 36px; height: 36px; }

        .input-field {
            background: var(--bg-core);
            border: 1px solid var(--border);
            color: white;
            padding: 10px 12px;
            border-radius: 4px;
            outline: none;
            font-size: 13px;
            width: 100%;
            transition: border-color 0.2s;
        }
        .input-field:focus { border-color: var(--accent); }

        /* Chat Specifics */
        .chat-container { flex: 1; overflow-y: auto; padding: 12px; display: flex; flex-direction: column; gap: 4px; }
        .chat-message {
            padding: 6px 8px;
            border-radius: 4px;
            font-size: 13px;
            line-height: 1.5;
            position: relative;
            border-left: 2px solid transparent;
        }
        .chat-message:hover { background: rgba(255,255,255,0.03); border-left-color: var(--accent); }
        
        /* Inline Mod Tools */
        .mod-actions-overlay {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            background: var(--bg-element);
            border: 1px solid var(--border);
            border-radius: 4px;
            padding: 2px;
            display: none;
            box-shadow: 0 4px 12px rgba(0,0,0,0.5);
            z-index: 10;
        }
        .chat-message:hover .mod-actions-overlay { display: flex; gap: 2px; }
        
        .mod-action-btn {
            width: 24px; height: 24px;
            display: flex; align-items: center; justify-content: center;
            border-radius: 2px;
            cursor: pointer;
            font-size: 12px;
        }
        .mod-action-btn:hover { background: var(--border); }
        .mod-action-btn.delete:hover { background: var(--danger); color: white; }
        .mod-action-btn.timeout:hover { background: var(--warning); color: black; }
        .mod-action-btn.ban:hover { background: black; color: white; border: 1px solid white; }

        /* Login Overlay */
        #login-screen {
            position: fixed; inset: 0; z-index: 999;
            background: radial-gradient(circle at center, #1f1f23 0%, #09090b 100%);
            display: flex; align-items: center; justify-content: center;
        }
        .login-card {
            background: var(--bg-panel);
            border: 1px solid var(--border);
            padding: 48px;
            border-radius: 12px;
            width: 450px;
            text-align: center;
            box-shadow: 0 20px 40px rgba(0,0,0,0.4);
        }

        /* Animations */
        @keyframes pulse-dot { 0% { opacity: 0.4; } 50% { opacity: 1; } 100% { opacity: 0.4; } }
        .live-dot { width: 8px; height: 8px; background: var(--danger); border-radius: 50%; display: inline-block; animation: pulse-dot 1.5s infinite; }
    </style>
</head>
<body>

    <div id="login-screen">
        <div class="login-card">
            <div class="flex justify-center mb-6">
                <div class="w-16 h-16 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl flex items-center justify-center shadow-lg">
                    <span class="text-3xl font-bold text-white">Ox</span>
                </div>
            </div>
            <h1 class="text-2xl font-bold mb-2">Onyx Dashboard</h1>
            <p class="text-gray-400 text-sm mb-8">Advanced Twitch Moderation Environment</p>
            
            <button onclick="Auth.login()" class="w-full bg-[#6441a5] hover:bg-[#503484] text-white font-bold py-3 px-4 rounded transition flex items-center justify-center gap-3">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M11.571 4.714h1.715v5.143H11.57zm4.715 0H18v5.143h-1.714zM6 0L1.714 4.286v15.428h5.143V24l4.286-4.286h3.428L22.286 12V0zm14.571 11.143l-3.428 3.428h-3.429l-3 3v-3H6.857V1.714h13.714Z"/></svg>
                Connect via Twitch
            </button>
            <div id="auth-status" class="mt-4 text-xs text-gray-500 mono hidden">Initializing OAuth Handshake...</div>
        </div>
    </div>

    <div id="app-root" class="dashboard-grid hidden">
        
        <header class="area-header">
            <div class="flex items-center gap-4">
                <div class="flex items-center gap-2">
                    <div class="w-8 h-8 bg-indigo-600 rounded flex items-center justify-center font-bold">Ox</div>
                    <span class="font-bold tracking-wide">ONYX</span>
                </div>
                <div class="h-6 w-px bg-gray-700 mx-2"></div>
                <div class="flex items-center gap-2 text-sm text-gray-400">
                    <span>Target:</span>
                    <span id="target-channel-display" class="text-white font-bold mono">---</span>
                </div>
            </div>

            <div class="flex items-center gap-6">
                <div id="connection-status" class="flex items-center gap-2 text-xs font-bold text-red-500">
                    <span class="w-2 h-2 rounded-full bg-red-500"></span> DISCONNECTED
                </div>
                <div class="flex items-center gap-3 pl-6 border-l border-gray-700">
                    <img id="user-avatar" src="" class="w-8 h-8 rounded bg-gray-800">
                    <div class="flex flex-col">
                        <span id="user-name" class="text-xs font-bold leading-none mb-1">Guest</span>
                        <span class="text-[10px] text-gray-500 mono leading-none">MODERATOR</span>
                    </div>
                    <button onclick="Auth.logout()" class="ml-2 text-gray-500 hover:text-white transition">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path></svg>
                    </button>
                </div>
            </div>
        </header>

        <aside class="area-sidebar p-4 gap-4">
            <div class="space-y-1">
                <div class="text-[10px] font-bold text-gray-500 uppercase tracking-wider mb-2">Quick Actions</div>
                <button onclick="ModActions.run('/clear')" class="w-full btn justify-start text-xs">
                    <span class="text-yellow-500">üßπ</span> Clear Chat
                </button>
                <button onclick="ModActions.run('/subsonly')" class="w-full btn justify-start text-xs">
                    <span class="text-purple-500">üíé</span> Subs Only
                </button>
                <button onclick="ModActions.run('/emoteonly')" class="w-full btn justify-start text-xs">
                    <span class="text-blue-500">üòä</span> Emote Only
                </button>
                <button onclick="ModActions.run('/slow 10')" class="w-full btn justify-start text-xs">
                    <span class="text-orange-500">üê¢</span> Slow 10s
                </button>
            </div>

            <div class="h-px bg-gray-800 my-2"></div>

            <div>
                <div class="text-[10px] font-bold text-gray-500 uppercase tracking-wider mb-2">Shield Protocol</div>
                <button id="btn-shield" onclick="ModActions.toggleShield()" class="w-full btn btn-danger justify-center py-4 relative overflow-hidden group">
                    <div class="absolute inset-0 bg-red-600 opacity-0 group-hover:opacity-10 transition"></div>
                    <span class="relative z-10 flex items-center gap-2 font-bold">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>
                        LOCKDOWN
                    </span>
                </button>
                <p class="text-[10px] text-gray-500 mt-2 text-center">Subs Only + Emote Only + Clear + Slow 30s</p>
            </div>

            <div class="mt-auto">
                <div class="bg-gray-800 rounded p-3 text-xs">
                    <div class="flex justify-between mb-1">
                        <span class="text-gray-400">Session Uptime</span>
                        <span id="uptime-clock" class="mono text-white">00:00:00</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-400">Events Logged</span>
                        <span id="event-counter" class="mono text-indigo-400">0</span>
                    </div>
                </div>
            </div>
        </aside>

        <main class="area-stream flex items-center justify-center">
            <div id="video-placeholder" class="text-center">
                <div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-500 mx-auto mb-4"></div>
                <p class="text-gray-400 text-sm">Waiting for Channel Selection...</p>
            </div>
            <div id="video-embed-container" class="w-full h-full hidden">
                </div>
            
            <div class="absolute top-4 right-4 bg-black/80 backdrop-blur px-3 py-1 rounded text-xs font-bold flex items-center gap-2 border border-white/10">
                <span class="live-dot"></span> LIVE FEED
            </div>
        </main>

        <section class="area-logs">
            <div class="bg-gray-900 border-b border-gray-800 px-4 py-2 flex justify-between items-center">
                <span class="text-xs font-bold text-gray-400 uppercase">Operation Logs</span>
                <button onclick="Logs.clear()" class="text-[10px] text-gray-500 hover:text-white">CLEAR LOGS</button>
            </div>
            <div id="system-logs" class="flex-1 overflow-y-auto p-4 font-mono text-xs space-y-1 select-text text-gray-300">
                </div>
        </section>

        <aside class="area-chat">
            <div class="bg-gray-900 border-b border-gray-800 px-4 py-3 flex justify-between items-center shadow-sm z-10">
                <span class="font-bold text-sm">Chat Feed</span>
                <div class="flex items-center gap-2">
                    <span id="chat-status-indicator" class="w-2 h-2 bg-gray-500 rounded-full"></span>
                </div>
            </div>

            <div id="chat-feed" class="chat-container">
                <div class="text-center text-gray-500 text-sm mt-10 italic">Connecting to IRC...</div>
            </div>

            <div class="p-4 bg-gray-900 border-t border-gray-800">
                <form onsubmit="Chat.submit(event)" class="relative">
                    <input type="text" id="message-input" class="input-field pr-16" placeholder="Send a message..." autocomplete="off">
                    <button type="submit" class="absolute right-2 top-1.5 text-xs bg-indigo-600 hover:bg-indigo-500 text-white px-2 py-1.5 rounded font-bold">SEND</button>
                </form>
            </div>
        </aside>

    </div>

    <script>
        /**
         * ONYX CORE CONFIGURATION
         * Centralized settings for easy deployment.
         */
        const Config = {
            clientID: 'uqf5d6at2fnet8w5tylz17l2sb4onx',
            redirectURI: 'https://serowsour.github.io/aabot/', // CHANGE THIS IF LOCALHOST
            scope: 'chat:read chat:edit channel:moderate user:read:email moderator:manage:banned_users',
            parentDomain: window.location.hostname === 'localhost' ? 'localhost' : 'serowsour.github.io'
        };

        /**
         * STATE MANAGEMENT
         * Handles the runtime data of the application.
         */
        const State = {
            token: null,
            user: null,
            targetChannel: null,
            client: null,
            isShieldActive: false,
            logsCount: 0,
            startTime: Date.now()
        };

        /**
         * AUTHENTICATION MODULE
         * Manages Twitch OAuth2 flow and User Data retrieval.
         */
        const Auth = {
            init() {
                const hash = window.location.hash;
                if (hash.includes('access_token')) {
                    document.getElementById('auth-status').classList.remove('hidden');
                    const params = new URLSearchParams(hash.substring(1));
                    State.token = params.get('access_token');
                    
                    // Clean URL
                    window.history.pushState({}, document.title, window.location.pathname);
                    
                    this.validateToken();
                }
            },

            login() {
                const url = `https://id.twitch.tv/oauth2/authorize?client_id=${Config.clientID}&redirect_uri=${encodeURIComponent(Config.redirectURI)}&response_type=token&scope=${encodeURIComponent(Config.scope)}`;
                window.location.href = url;
            },

            logout() {
                State.token = null;
                window.location.reload();
            },

            async validateToken() {
                try {
                    Logs.add('System', 'Validating Token with Helix API...');
                    const response = await fetch('https://api.twitch.tv/helix/users', {
                        headers: {
                            'Authorization': `Bearer ${State.token}`,
                            'Client-ID': Config.clientID
                        }
                    });

                    if (!response.ok) throw new Error('Token Invalid');

                    const data = await response.json();
                    State.user = data.data[0];
                    
                    this.completeLogin();
                } catch (error) {
                    console.error(error);
                    alert("Authentication Failed. Please login again.");
                    this.logout();
                }
            },

            completeLogin() {
                // UI Transition
                document.getElementById('login-screen').classList.add('hidden');
                document.getElementById('app-root').classList.remove('hidden');
                document.getElementById('app-root').style.display = 'grid'; // Ensure grid layout
                
                // Set User Info
                document.getElementById('user-avatar').src = State.user.profile_image_url;
                document.getElementById('user-name').innerText = State.user.display_name;

                // Prompt for Channel
                setTimeout(() => {
                    const channel = prompt("ENTER TARGET CHANNEL NAME (CASE INSENSITIVE):");
                    if (channel) {
                        State.targetChannel = channel.toLowerCase().trim();
                        App.start();
                    } else {
                        this.logout();
                    }
                }, 500);
            }
        };

        /**
         * APP CONTROLLER
         * Orchestrates the initialization of sub-systems.
         */
        const App = {
            start() {
                document.getElementById('target-channel-display').innerText = State.targetChannel.toUpperCase();
                
                // Initialize Systems
                Video.load();
                Chat.connect();
                Logs.add('System', `Initializing Onyx for channel: ${State.targetChannel}`);
                
                // Start Timer
                setInterval(() => {
                    const diff = Date.now() - State.startTime;
                    const date = new Date(diff);
                    const str = date.toISOString().substring(11, 19);
                    document.getElementById('uptime-clock').innerText = str;
                }, 1000);
            }
        };

        /**
         * VIDEO MODULE
         * Manages the Twitch Embed Player.
         */
        const Video = {
            load() {
                const container = document.getElementById('video-embed-container');
                const placeholder = document.getElementById('video-placeholder');
                
                placeholder.classList.add('hidden');
                container.classList.remove('hidden');
                
                container.innerHTML = `
                    <iframe
                        src="https://player.twitch.tv/?channel=${State.targetChannel}&parent=${Config.parentDomain}&autoplay=true&muted=false"
                        height="100%"
                        width="100%"
                        allowfullscreen>
                    </iframe>
                `;
            }
        };

        /**
         * CHAT & TMI MODULE
         * Handles IRC connection, message rendering, and commands.
         */
        const Chat = {
            connect() {
                State.client = new tmi.Client({
                    options: { debug: false },
                    connection: {
                        secure: true,
                        reconnect: true
                    },
                    identity: {
                        username: State.user.login,
                        password: `oauth:${State.token}`
                    },
                    channels: [State.targetChannel]
                });

                State.client.connect()
                    .then(() => {
                        this.updateStatus(true);
                        Logs.add('Network', 'Connected to Twitch IRC Edge Server');
                        document.getElementById('chat-feed').innerHTML = ''; // Clear loading msg
                        this.addSystemMessage(`Welcome to #${State.targetChannel}. Onyx is ready.`);
                    })
                    .catch((err) => {
                        this.updateStatus(false);
                        Logs.add('Error', `Connection Failed: ${err}`);
                    });

                this.registerEvents();
            },

            updateStatus(connected) {
                const badge = document.getElementById('connection-status');
                const dot = document.getElementById('chat-status-indicator');
                
                if (connected) {
                    badge.innerHTML = `<span class="w-2 h-2 rounded-full bg-green-500"></span> ONLINE`;
                    badge.classList.replace('text-red-500', 'text-green-500');
                    dot.classList.replace('bg-gray-500', 'bg-green-500');
                } else {
                    badge.innerHTML = `<span class="w-2 h-2 rounded-full bg-red-500"></span> DISCONNECTED`;
                    badge.classList.replace('text-green-500', 'text-red-500');
                    dot.classList.replace('bg-green-500', 'bg-red-500');
                }
            },

            registerEvents() {
                State.client.on('message', (channel, tags, message, self) => {
                    this.renderMessage(tags, message);
                });

                State.client.on('clearchat', () => {
                    this.addSystemMessage('CAUTION: Chat Cleared by a Moderator.');
                    Logs.add('ModAction', 'Chat Cleared');
                });

                State.client.on('ban', (channel, username, reason) => {
                    Logs.add('Ban', `User ${username} banned. Reason: ${reason || 'N/A'}`);
                });
            },

            renderMessage(tags, message) {
                const feed = document.getElementById('chat-feed');
                const div = document.createElement('div');
                div.className = 'chat-message group';
                
                const isMod = tags.mod || tags.badges?.broadcaster === '1';
                const color = tags.color || '#a1a1aa';
                const time = new Date().toLocaleTimeString('it-IT', { hour: '2-digit', minute: '2-digit' });

                // Construct HTML
                div.innerHTML = `
                    <div class="mod-actions-overlay">
                        <div class="mod-action-btn delete" onclick="ModActions.delete('${tags.id}')" title="Delete Message">üóëÔ∏è</div>
                        <div class="mod-action-btn timeout" onclick="ModActions.timeout('${tags.username}')" title="Timeout 10m">‚è±Ô∏è</div>
                        <div class="mod-action-btn ban" onclick="ModActions.ban('${tags.username}')" title="Permaban">üö´</div>
                    </div>
                    <div class="flex items-baseline gap-2">
                        <span class="text-[10px] text-gray-500 mono">${time}</span>
                        ${isMod ? '<span class="bg-gray-700 text-[9px] px-1 rounded text-white font-bold">MOD</span>' : ''}
                        <span class="text-sm font-bold cursor-pointer hover:underline" style="color: ${color}" onclick="Chat.mention('${tags.username}')">${tags['display-name']}</span>
                    </div>
                    <div class="text-gray-300 break-words">${this.formatEmotes(message, tags.emotes)}</div>
                `;

                feed.appendChild(div);
                
                // Auto Scroll
                if (feed.scrollTop + feed.clientHeight >= feed.scrollHeight - 100) {
                    feed.scrollTop = feed.scrollHeight;
                }
            },

            addSystemMessage(text) {
                const feed = document.getElementById('chat-feed');
                const div = document.createElement('div');
                div.className = 'px-2 py-1 my-1 border-l-2 border-indigo-500 bg-indigo-500/10 text-xs text-indigo-200 font-mono';
                div.innerText = `[SYSTEM] ${text}`;
                feed.appendChild(div);
                feed.scrollTop = feed.scrollHeight;
            },

            formatEmotes(message, emotes) {
                // Simplified emote handling (pass-through for now to keep code light, can be expanded)
                return message; 
            },

            submit(e) {
                e.preventDefault();
                const input = document.getElementById('message-input');
                const msg = input.value;
                if (msg && State.client) {
                    State.client.say(State.targetChannel, msg);
                    input.value = '';
                    // Local Echo
                    Logs.add('You', msg);
                }
            },

            mention(username) {
                const input = document.getElementById('message-input');
                input.value = `@${username} ` + input.value;
                input.focus();
            }
        };

        /**
         * MODERATION ACTIONS MODULE
         * Handles execution of mod commands.
         */
        const ModActions = {
            run(command) {
                if (!State.client) return;
                State.client.say(State.targetChannel, command);
                Logs.add('Command', `Executed: ${command}`);
            },

            delete(msgId) {
                this.run(`/delete ${msgId}`);
                Logs.add('ModAction', `Deleted message ID: ...${msgId.substr(-4)}`);
            },

            timeout(user) {
                if(confirm(`Timeout ${user} for 600 seconds?`)) {
                    this.run(`/timeout ${user} 600`);
                }
            },

            ban(user) {
                if(confirm(`WARNING: Are you sure you want to BAN ${user}?`)) {
                    this.run(`/ban ${user}`);
                }
            },

            toggleShield() {
                State.isShieldActive = !State.isShieldActive;
                const btn = document.getElementById('btn-shield');
                
                if (State.isShieldActive) {
                    // Activate Shield
                    this.run('/subsonly');
                    this.run('/emoteonly');
                    this.run('/slow 30');
                    this.run('/clear');
                    
                    btn.classList.add('bg-red-600', 'animate-pulse');
                    btn.innerHTML = `<span class="relative z-10 flex items-center gap-2 font-bold">‚ö†Ô∏è SHIELD ACTIVE</span>`;
                    Chat.addSystemMessage('SHIELD MODE ENGAGED. Chat locked down.');
                } else {
                    // Deactivate
                    this.run('/subsonlyoff');
                    this.run('/emoteonlyoff');
                    this.run('/slowoff');
                    
                    btn.classList.remove('bg-red-600', 'animate-pulse');
                    btn.innerHTML = `<span class="relative z-10 flex items-center gap-2 font-bold"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>LOCKDOWN</span>`;
                    Chat.addSystemMessage('Shield Mode disengaged. Restrictions lifted.');
                }
            }
        };

        /**
         * LOGGING MODULE
         * Displays system events and actions.
         */
        const Logs = {
            add(source, message) {
                const container = document.getElementById('system-logs');
                const line = document.createElement('div');
                const time = new Date().toLocaleTimeString();
                
                line.innerHTML = `<span class="text-gray-500">[${time}]</span> <span class="text-indigo-400 font-bold">${source}:</span> ${message}`;
                container.prepend(line);
                
                // Cleanup old logs if too many
                if (container.children.length > 100) {
                    container.lastChild.remove();
                }

                State.logsCount++;
                document.getElementById('event-counter').innerText = State.logsCount;
            },
            
            clear() {
                document.getElementById('system-logs').innerHTML = '';
            }
        };

        // Initialize App on Load
        window.onload = () => Auth.init();

    </script>
</body>
</html>
